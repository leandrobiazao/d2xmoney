<div class="fiis-container">
  <!-- Positions Section -->
  <section class="positions-section">
    <div class="section-header">
      <h3>Posições Atuais</h3>
    </div>

    @if (showPositions && fiiPositions.length > 0) {
    <div class="summary-cards">
      <div class="summary-card">
        <span class="label">Total Investido:</span>
        <span class="value">{{ formatCurrency(getTotalInvestido()) }}</span>
      </div>
      <div class="summary-card">
        <span class="label">Valor Atual:</span>
        <span class="value">{{ formatCurrency(getTotalValorAtual()) }}</span>
      </div>
      <div class="summary-card">
        <span class="label">FIIs na Carteira:</span>
        <span class="value">{{ getActivePositionsCount() }}</span>
      </div>
    </div>

    <table class="positions-table">
      <thead>
        <tr>
          <th>Título</th>
          <th>Quantidade</th>
          <th>Preço Médio</th>
          <th>Valor Total Investido</th>
          <th>Preço Atual</th>
          <th>Valor Atual</th>
          <th>Lucro</th>
        </tr>
      </thead>
      <tbody>
        @for (position of fiiPositions; track position.titulo) {
        <tr>
          <td>{{ position.titulo }}</td>
          <td>{{ position.quantidadeTotal }}</td>
          <td>{{ formatCurrency(position.precoMedioPonderado) }}</td>
          <td>{{ formatCurrency(position.valorTotalInvestido) }}</td>
          <td>{{ formatCurrency(position.currentPrice || position.precoMedioPonderado) }}</td>
          <td>{{ formatCurrency(position.valorAtual || (position.quantidadeTotal * position.precoMedioPonderado)) }}</td>
          <td [class.positive]="(position.totalLucro || 0) > 0" [class.negative]="(position.totalLucro || 0) < 0">
            {{ formatCurrency(position.totalLucro || 0) }}
          </td>
        </tr>
        }
      </tbody>
    </table>
    }
  </section>

  @if (isLoading) {
  <div class="loading">Carregando...</div>
  }
</div>
